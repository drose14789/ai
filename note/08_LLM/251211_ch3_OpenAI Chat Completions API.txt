5. 고급 활용법
이 섹션에서는 Chat Completions API를 보다 효율적으로 사용하기 위한 고급 기법들을 다룸.
토큰 사용을 최적화하여 비용을 절감하는 방법과, API 호출 시 발생할 수 있는 오류를 처리하는 방법을
설명

- 토큰 최적화 및 비용 절감
OpenAI API 비용은 사용한 토큰(token) 수에 비례하여 청구됨. 따라서 동일한 작업을 하더라도 
토큰을 적게 사용하면 비용이 줄어들고, 응답 속도도 빨라짐. GPT-4o 모델은 최대 128k 토큰의 
컨텍스트를 지원하지만, 불필요하게 많은 토큰을 사용하지 않도록 최적화하는 것이 중요함.

- 토큰 최적화를 위한 팁:
짧고 명확한 프롬프트: 시스템 메시지와 사용자 메시지를 불필요하게 장황하게 쓰지 않고 간결하게 
작성 예를 들어 동일한 지시라도 "간결하게 답변해주세요."는 
"부디 당신의 답변을 최대한 간략하게 제공해 주셨으면 합니다."보다 적은 토큰으로 같은 의미를 
전달함

대화 내역 관리: 이전 대화 기록을 얼마나 포함시킬지 결정해야 함. 모든 이전 메시지를 매번 보낼 
필요는 없음. 중요한 맥락만 남기고 요약하거나 일부 생략하여 토큰을 줄임.

모델 선택: 반드시 GPT-4o 수준의 성능이 필요하지 않은 작업에는 GPT-4o-mini와 같은 더 작은 
모델을 사용해 비용을 절감할 수 있음. (GPT-4o-mini는 GPT-4o보다 비용이 훨씬 저렴하여 
일상적인 작업에 적합.)

max_tokens 파라미터 활용: 응답의 최대 길이를 설정하여 너무 긴 답변이 나오지 않도록 제어함. 
예를 들어 요약 생성 등의 작업에서는 max_tokens를 짧게 설정해 모델이 알아서 간결한 답을 
내놓게 유도할 수 있음 

스트리밍과 부분 처리: 앞서 소개한 스트리밍 기능을 사용하면, 매우 긴 응답의 경우 중간 중간 출력 
결과를 확인하며 필요에 따라 조기에 중단하는 등의 대응을 할 수 있음.

추가로, OpenAI는 Batch API 등을 통해 다수의 요청을 한 번에 보내 비용을 절약하는 방법을 
제공하기도 함. 다만 이 튜토리얼의 범위를 벗어나므로 자세한 내용은 OpenAI 공식 문서를 참고

토큰 최적화의 효과를 확인하고 싶다면, 응답 객체의 usage 정보를 출력해볼 수 있음.
response.usage에는 이번 요청에서 사용된 prompt_tokens(입력 토큰 수), 
completion_tokens(출력 토큰 수), total_tokens(합계)가 담겨 있음

6. 실전 프로젝트 예제

간단한 대화형 챗봇 구현
OpenAI Chat Completions API를 사용하면 비교적 적은 코드로 대화형 챗봇을 만들 수 있음 
여기서는 콘솔에서 사용자의 입력을 받아 모델의 응답을 출력하는 간단한 챗봇을 구현해봄 
이 챗봇은 이전 대화 맥락을 기억하여 연속적인 대화를 주고받을 수 있음